{"version":3,"file":"useSticky.mjs","sources":["../../../../src/hooks/useSticky/useSticky.ts"],"sourcesContent":["import { useEffect, useState } from 'react';\n\nimport type { HookTarget } from '@/utils/helpers';\n\nimport { getElement, isTarget } from '@/utils/helpers';\n\nimport type { StateRef } from '../useRefState/useRefState';\n\nimport { useRefState } from '../useRefState/useRefState';\n\n/** The use sticky return type */\nexport interface UseStickyReturn {\n  stuck: boolean;\n}\n\n/** The use sticky axis type */\nexport type UseStickyAxis = 'horizontal' | 'vertical';\n\n/** The use sticky options type */\nexport interface UseStickyOptions {\n  axis?: UseStickyAxis;\n  root?: HookTarget;\n}\n\nexport interface UseSticky {\n  (target: HookTarget, options?: UseStickyOptions): boolean;\n\n  <Target extends Element>(\n    options?: UseStickyOptions,\n    target?: never\n  ): {\n    ref: StateRef<Target>;\n  } & UseStickyReturn;\n}\n\n/**\n * @name UseSticky\n * @description - Hook that allows you to detect that your sticky component is stuck\n * @category Elements\n *\n * @overload\n * @param {HookTarget} target The target sticky element\n * @param {UseStickyAxis} [options.axis='vertical'] The axis of motion of the sticky component\n * @param {UseStickyRoot} [options.root=document] The element that contains your sticky component\n * @returns {UseStickyReturn} The state of the sticky\n *\n * @example\n * const stuck  = useSticky(ref);\n *\n * @overload\n * @param {UseStickyAxis} [options.axis='vertical'] The axis of motion of the sticky component\n * @param {UseStickyRoot} [options.root=document] The element that contains your sticky component\n * @returns {{ stickyRef: StateRef<Target> } & UseStickyReturn} The state of the sticky\n *\n * @example\n * const { stuck, ref } = useSticky();\n */\nexport const useSticky = ((...params: any[]) => {\n  const target = (isTarget(params[0]) ? params[0] : undefined) as HookTarget | undefined;\n  const options = (target ? params[1] : params[0]) as UseStickyOptions;\n  const axis = options?.axis ?? 'vertical';\n\n  const internalRef = useRefState<Element>();\n  const [stuck, setStuck] = useState(false);\n\n  useEffect(() => {\n    if (!target && !internalRef.state) return;\n\n    const element = (target ? getElement(target) : internalRef.current) as Element;\n\n    if (!element) return;\n\n    const root = (options?.root ? getElement(options.root) : document) as Element;\n    const elementOffsetTop =\n      element.getBoundingClientRect().top + root.scrollTop - root.getBoundingClientRect().top;\n    const elementOffsetLeft =\n      element.getBoundingClientRect().left + root.scrollLeft - root.getBoundingClientRect().left;\n\n    const onSticky = () => {\n      if (axis === 'vertical') {\n        const scrollTop = root.scrollTop;\n        setStuck(scrollTop >= elementOffsetTop);\n      }\n\n      if (axis === 'horizontal') {\n        const scrollLeft = root.scrollLeft;\n        setStuck(scrollLeft >= elementOffsetLeft);\n      }\n    };\n\n    root.addEventListener('scroll', onSticky);\n    window.addEventListener('resize', onSticky);\n    window.addEventListener('orientationchange', onSticky);\n\n    onSticky();\n\n    return () => {\n      root.removeEventListener('scroll', onSticky);\n      window.removeEventListener('resize', onSticky);\n      window.removeEventListener('orientationchange', onSticky);\n    };\n  }, [target, internalRef.state, axis, options?.root]);\n\n  if (target) return stuck;\n  return {\n    stuck,\n    ref: internalRef\n  };\n}) as UseSticky;\n"],"names":["useSticky","params","target","isTarget","options","axis","internalRef","useRefState","stuck","setStuck","useState","useEffect","element","getElement","root","elementOffsetTop","elementOffsetLeft","onSticky","scrollTop","scrollLeft"],"mappings":";;;;AAyDO,MAAMA,IAAa,IAAIC,MAAkB;AAC9C,QAAMC,IAAUC,EAASF,EAAO,CAAC,CAAC,IAAIA,EAAO,CAAC,IAAI,QAC5CG,IAAWF,IAASD,EAAO,CAAC,IAAIA,EAAO,CAAC,GACxCI,IAAOD,GAAS,QAAQ,YAExBE,IAAcC,EAAA,GACd,CAACC,GAAOC,CAAQ,IAAIC,EAAS,EAAK;AAwCxC,SAtCAC,EAAU,MAAM;AACd,QAAI,CAACT,KAAU,CAACI,EAAY,MAAO;AAEnC,UAAMM,IAAWV,IAASW,EAAWX,CAAM,IAAII,EAAY;AAE3D,QAAI,CAACM,EAAS;AAEd,UAAME,IAAQV,GAAS,OAAOS,EAAWT,EAAQ,IAAI,IAAI,UACnDW,IACJH,EAAQ,wBAAwB,MAAME,EAAK,YAAYA,EAAK,sBAAA,EAAwB,KAChFE,IACJJ,EAAQ,wBAAwB,OAAOE,EAAK,aAAaA,EAAK,sBAAA,EAAwB,MAElFG,IAAW,MAAM;AACrB,UAAIZ,MAAS,YAAY;AACvB,cAAMa,IAAYJ,EAAK;AACvB,QAAAL,EAASS,KAAaH,CAAgB;AAAA,MAAA;AAGxC,UAAIV,MAAS,cAAc;AACzB,cAAMc,IAAaL,EAAK;AACxB,QAAAL,EAASU,KAAcH,CAAiB;AAAA,MAAA;AAAA,IAC1C;AAGF,WAAAF,EAAK,iBAAiB,UAAUG,CAAQ,GACxC,OAAO,iBAAiB,UAAUA,CAAQ,GAC1C,OAAO,iBAAiB,qBAAqBA,CAAQ,GAErDA,EAAA,GAEO,MAAM;AACX,MAAAH,EAAK,oBAAoB,UAAUG,CAAQ,GAC3C,OAAO,oBAAoB,UAAUA,CAAQ,GAC7C,OAAO,oBAAoB,qBAAqBA,CAAQ;AAAA,IAAA;AAAA,EAC1D,GACC,CAACf,GAAQI,EAAY,OAAOD,GAAMD,GAAS,IAAI,CAAC,GAE/CF,IAAeM,IACZ;AAAA,IACL,OAAAA;AAAA,IACA,KAAKF;AAAA,EAAA;AAET;"}