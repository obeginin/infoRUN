"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const c=require("react"),R=require("../useEvent/useEvent.cjs"),d=require("../../utils/helpers/getRetry.cjs"),S=(o,t)=>{const r=c.useRef(void 0),s=c.useRef(t?.retry?d.getRetry(t.retry):0),f=c.useRef(!1),[y,u]=c.useState("connecting"),a=e=>r.current?.send(e),l=()=>{f.current=!0,r.current?.close()},i=R.useEvent(()=>{r.current=new WebSocket(typeof o=="function"?o():o,t?.protocols),u("connecting");const e=r.current;e&&(e.onopen=()=>{u("connected"),t?.onConnected?.(e)},e.onerror=n=>{u("failed"),t?.onError?.(n,e)},e.onmessage=n=>t?.onMessage?.(n,e),e.onclose=n=>{if(u("disconnected"),t?.onDisconnected?.(n,e),!f.current){if(s.current>0)return s.current-=1,i();s.current=t?.retry?d.getRetry(t.retry):0}})});c.useEffect(()=>(i(),()=>{r.current&&(r.current.close(),r.current=void 0)}),[o]);const g=()=>{f.current=!1,i()};return{client:r.current,close:l,open:g,send:a,status:y}};exports.useWebSocket=S;
//# sourceMappingURL=useWebSocket.cjs.map
