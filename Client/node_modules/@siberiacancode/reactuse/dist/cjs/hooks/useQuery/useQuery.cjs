"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t=require("react"),A=require("../useDidUpdate/useDidUpdate.cjs"),F=require("../useMount/useMount.cjs"),b=require("../../utils/helpers/getRetry.cjs"),L=(D,e)=>{const a=e?.enabled??!0,n=t.useRef(e?.retry?b.getRetry(e.retry):0),h=t.useRef(!1),[q,f]=t.useState(!1),[E,l]=t.useState(!1),[C,o]=t.useState(!1),[M,i]=t.useState(!1),[k,g]=t.useState(!!e?.placeholderData),[m,v]=t.useState(void 0),[w,R]=t.useState(e?.placeholderData),y=t.useRef(new AbortController),I=t.useRef(void 0),d=e?.keys??[],S=()=>{y.current.abort(),y.current=new AbortController},c=s=>{S(),f(!0),s==="init"&&(h.current=!0,l(!0)),s==="refetch"&&i(!0),D({signal:y.current.signal,keys:d}).then(r=>{const u=e?.select?e?.select(r):r;e?.onSuccess?.(u),R(u),g(!0),v(void 0),o(!1),f(!1),s==="init"&&l(!1),s==="refetch"&&i(!1)}).catch(r=>{if(n.current>0){n.current-=1;const u=typeof e?.retryDelay=="function"?e?.retryDelay(n.current,r):e?.retryDelay;if(u){setTimeout(()=>c(s),u);return}return c(s)}e?.onError?.(r),R(void 0),g(!1),v(r),o(!0),f(!1),s==="init"&&l(!1),s==="refetch"&&i(!1),n.current=e?.retry?b.getRetry(e.retry):0}).finally(()=>{if(e?.refetchInterval){const r=setInterval(()=>{clearInterval(r),c("refetch")},e?.refetchInterval);I.current=r}})};return F.useMount(()=>{a&&c("init")}),A.useDidUpdate(()=>{a&&c(h.current?"refetch":"init")},[a,...d]),t.useEffect(()=>()=>{clearInterval(I.current)},[a,e?.refetchInterval,e?.retry,...d]),{abort:S,data:w,error:m,refetch:()=>c("refetch"),isFetching:q,isLoading:E,isError:C,isSuccess:k,isRefetching:M}};exports.useQuery=L;
//# sourceMappingURL=useQuery.cjs.map
