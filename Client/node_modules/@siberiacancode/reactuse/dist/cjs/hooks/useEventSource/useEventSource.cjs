"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t=require("react"),E=require("../../utils/helpers/getRetry.cjs"),O=(g,m=[],e={})=>{const[v,c]=t.useState(!1),[R,l]=t.useState(!1),[D,y]=t.useState(!1),u=t.useRef(e?.retry?E.getRetry(e.retry):0),[C,d]=t.useState(void 0),[h,i]=t.useState(e?.placeholderData),a=t.useRef(void 0),S=e.immediately??!0,o=()=>{a.current&&(a.current.close(),a.current=void 0,l(!1),c(!1),y(!1))},f=()=>{o();const n=new EventSource(g,{withCredentials:e.withCredentials??!1});a.current=n,c(!0),n.onopen=()=>{l(!0),c(!1),d(void 0),e?.onOpen?.()},n.onerror=r=>{if(l(!1),c(!1),y(!0),d(r),e?.onError?.(r),u.current>0){u.current-=1;const s=typeof e?.retryDelay=="function"?e?.retryDelay(u.current,r):e?.retryDelay;if(s){setTimeout(f,s);return}}u.current=e?.retry?E.getRetry(e.retry):0},n.onmessage=r=>{const s=e?.select?e?.select(r.data):r.data;i(s),e?.onMessage?.(r)},m.forEach(r=>{n.addEventListener(r,s=>{i(s.data)})})};return t.useEffect(()=>{if(S)return f(),()=>{o()}},[S]),{instance:a.current,data:h,error:C,isConnecting:v,isOpen:R,isError:D,close:o,open:f}};exports.useEventSource=O;
//# sourceMappingURL=useEventSource.cjs.map
