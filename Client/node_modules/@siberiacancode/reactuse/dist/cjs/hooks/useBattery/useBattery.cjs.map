{"version":3,"file":"useBattery.cjs","sources":["../../../../src/hooks/useBattery/useBattery.ts"],"sourcesContent":["import { useEffect, useState } from 'react';\n\nexport interface BatteryManager extends EventTarget {\n  charging: boolean;\n  chargingTime: number;\n  dischargingTime: number;\n  level: number;\n}\n\ndeclare global {\n  interface Navigator {\n    readonly getBattery: () => Promise<BatteryManager>;\n  }\n}\n\n/** The use battery value type */\nexport interface UseBatteryValue {\n  /** Is charging battery? */\n  charging: boolean;\n  /** Time until the battery is fully charged */\n  chargingTime: number;\n  /** Time until the battery is completely discharged */\n  dischargingTime: number;\n  /** Battery charge level from 0 to 1 */\n  level: number;\n  /** Is battery information loading? */\n  loading: boolean;\n}\n\n/** The use battery return type */\nexport interface UseBatteryStateReturn {\n  /** Whether the battery api is supported*/\n  supported: boolean;\n  /** The use battery value type  */\n  value: UseBatteryValue;\n}\n\n/**\n * @name useBattery\n * @description - Hook for getting information about battery status\n * @category Browser\n *\n * @browserapi navigator.getBattery https://developer.mozilla.org/en-US/docs/Web/API/Navigator/getBattery\n *\n * @returns {UseBatteryStateReturn} Object containing battery information & Battery API support\n *\n * @example\n * const { supported, loading, charging, chargingTime, dischargingTime, level } = useBattery();\n */\nexport const useBattery = (): UseBatteryStateReturn => {\n  const supported =\n    typeof navigator !== 'undefined' &&\n    'getBattery' in navigator &&\n    typeof navigator.getBattery === 'function';\n  const [value, setValue] = useState<UseBatteryValue>({\n    loading: supported,\n    level: 0,\n    charging: false,\n    chargingTime: 0,\n    dischargingTime: 0\n  });\n\n  useEffect(() => {\n    if (!supported) return;\n\n    let battery: BatteryManager | null;\n\n    const onChange = () =>\n      setValue({\n        loading: false,\n        level: battery?.level ?? 0,\n        charging: battery?.charging ?? false,\n        dischargingTime: battery?.dischargingTime ?? 0,\n        chargingTime: battery?.chargingTime ?? 0\n      });\n\n    navigator.getBattery().then((batteryManager) => {\n      battery = batteryManager;\n      onChange();\n\n      battery.addEventListener('levelchange', onChange);\n      battery.addEventListener('chargingchange', onChange);\n      battery.addEventListener('chargingtimechange', onChange);\n      battery.addEventListener('dischargingtimechange', onChange);\n    });\n\n    return () => {\n      if (!battery) return;\n      console.log('unmount', battery);\n      battery.removeEventListener('levelchange', onChange);\n      battery.removeEventListener('chargingchange', onChange);\n      battery.removeEventListener('chargingtimechange', onChange);\n      battery.removeEventListener('dischargingtimechange', onChange);\n    };\n  }, []);\n\n  return { supported, value };\n};\n"],"names":["useBattery","supported","value","setValue","useState","useEffect","battery","onChange","batteryManager"],"mappings":"yGAiDaA,EAAa,IAA6B,CACrD,MAAMC,EACJ,OAAO,UAAc,KACrB,eAAgB,WAChB,OAAO,UAAU,YAAe,WAC5B,CAACC,EAAOC,CAAQ,EAAIC,WAA0B,CAClD,QAASH,EACT,MAAO,EACP,SAAU,GACV,aAAc,EACd,gBAAiB,CAAA,CAClB,EAEDI,OAAAA,EAAAA,UAAU,IAAM,CACd,GAAI,CAACJ,EAAW,OAEhB,IAAIK,EAEJ,MAAMC,EAAW,IACfJ,EAAS,CACP,QAAS,GACT,MAAOG,GAAS,OAAS,EACzB,SAAUA,GAAS,UAAY,GAC/B,gBAAiBA,GAAS,iBAAmB,EAC7C,aAAcA,GAAS,cAAgB,CAAA,CACxC,EAEH,iBAAU,WAAA,EAAa,KAAME,GAAmB,CAC9CF,EAAUE,EACVD,EAAA,EAEAD,EAAQ,iBAAiB,cAAeC,CAAQ,EAChDD,EAAQ,iBAAiB,iBAAkBC,CAAQ,EACnDD,EAAQ,iBAAiB,qBAAsBC,CAAQ,EACvDD,EAAQ,iBAAiB,wBAAyBC,CAAQ,CAAA,CAC3D,EAEM,IAAM,CACND,IACL,QAAQ,IAAI,UAAWA,CAAO,EAC9BA,EAAQ,oBAAoB,cAAeC,CAAQ,EACnDD,EAAQ,oBAAoB,iBAAkBC,CAAQ,EACtDD,EAAQ,oBAAoB,qBAAsBC,CAAQ,EAC1DD,EAAQ,oBAAoB,wBAAyBC,CAAQ,EAAA,CAC/D,EACC,EAAE,EAEE,CAAE,UAAAN,EAAW,MAAAC,CAAA,CACtB"}