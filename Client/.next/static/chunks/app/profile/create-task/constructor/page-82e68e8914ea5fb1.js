(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9738],{92:e=>{e.exports={container:"TaskConstructor_container__jHOjN",taskConstructor:"TaskConstructor_taskConstructor__6aQ2A"}},525:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});class a{static async login(e,t){return(await fetch("".concat("https://info-run.ru","/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Login:e,Password:t})})).json()}static async loginV2(e,t){return(await fetch("".concat("https://info-run.ru","/api/auth/login/v2"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:e,password:t})})).json()}static async logout(e){return(await fetch("".concat("https://info-run.ru","/api/auth/logout"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})).json()}static async resetPassword(e){return(await fetch("".concat("https://info-run.ru","/api/auth/password_reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Email:e})})).json()}static async resetPasswordWithToken(e,t,r){let a=await fetch("".concat("https://info-run.ru","/api/auth/password_reset_with_token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,new_password:t,repeat_new_password:r})});return a.status,a.json()}}},1152:(e,t,r)=>{"use strict";r.d(t,{f:()=>o});var a=r(5155),n=r(9624),s=r.n(n);let o=e=>{let{value:t,onChange:r,placeholder:n="Введите текст..."}=e;return(0,a.jsx)("textarea",{className:s().textarea,value:t,onChange:e=>r(e.target.value),placeholder:n,rows:4})}},1639:()=>{},2078:e=>{e.exports={link:"AnimationLink_link__b_WaA"}},3010:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6874,23)),Promise.resolve().then(r.bind(r,9150)),Promise.resolve().then(r.t.bind(r,7465,23)),Promise.resolve().then(r.t.bind(r,2078,23)),Promise.resolve().then(r.t.bind(r,1639,23)),Promise.resolve().then(r.bind(r,7364))},3208:(e,t,r)=>{"use strict";r.d(t,{f:()=>n});var a=r(5155);let n=e=>{let{children:t,size:r="base",f_weight:n="light",color:s}=e;return(0,a.jsx)("p",{style:{fontSize:"var(--".concat(r,")"),fontWeight:"var(--fw_".concat(n,")"),color:"var(--".concat(s,")")},children:t})}},3429:e=>{e.exports={header:"Header_header__mjk9B",scrolled:"Header_scrolled__UEvVD",content__right:"Header_content__right__Xotbx",list:"Header_list__Oc7Pz",burger:"Header_burger__do6Rn",theme_switcher:"Header_theme_switcher__kCJqk",dark:"Header_dark__lAzRt",light:"Header_light__Whbrs"}},4001:e=>{e.exports={outside__content:"ProfileContentContainer_outside__content__7rkiJ",content:"ProfileContentContainer_content__90rmg"}},4403:(e,t,r)=>{"use strict";r.d(t,{L:()=>l});var a=r(5453),n=r(6786);class s{static async getSubjects(e){return(await fetch("".concat("https://info-run.ru","/api/subjects"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})).json()}static async getTaskNumber(e,t){return(await fetch("".concat("https://info-run.ru","/api/tasks?subject_id=").concat(t),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})).json()}}class o{static async create(e,t){return(await fetch("".concat("https://info-run.ru","/api/subtasks/create"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:t})).json()}}let l=(0,a.v)()((0,n.Zr)((e,t)=>({loading:!1,error:null,success:null,subject:null,subjects:[],task:null,tasks:[],elements:[],getSubjects:async()=>{e({loading:!0});let t=localStorage.getItem("token")||"";try{let r=await s.getSubjects(t);e({subjects:r.subjects,loading:!1})}catch(t){e({error:"Ошибка получения данных"+t,loading:!1})}},setSubject:t=>{e({subject:t})},getTaskNumber:async t=>{e({loading:!0});let r=localStorage.getItem("token")||"";try{let a=await s.getTaskNumber(r,t);e({tasks:a.tasks,loading:!1})}catch(t){e({error:"Ошибка получения данных"+t,loading:!1})}},setTask:t=>{e({task:t})},moveElement:(t,r)=>{e(e=>({elements:e.elements.map(a=>{if(a.id===t){let t=e.elements.indexOf(a);if("up"===r&&t>0)return e.elements[t-1];if("down"===r&&t<e.elements.length-1)return e.elements[t+1]}return a})}))},addElement:t=>{let r={id:Date.now().toString(),type:t,content:"text"===t?"":void 0,file:"image"===t?null:void 0};e(e=>({elements:[...e.elements,r]}))},updateElement:(t,r)=>{e(e=>({elements:e.elements.map(e=>e.id===t?{...e,...r}:e)}))},removeElement:t=>{e(e=>({elements:e.elements.filter(e=>e.id!==t)}))},handleSave:async()=>{e({loading:!0,success:null,error:null});let r=localStorage.getItem("token")||"",a=JSON.parse(localStorage.getItem("constructor-storage")||"").state.task.TaskID;try{var n;let s=new FormData;(null==(n=t().task)?void 0:n.TaskID)&&s.append("task_id",a);let l=[];t().elements.forEach((e,t)=>{"text"===e.type?l.push({type:"text",content:e.content||""}):"image"===e.type&&e.file&&(s.append("file_".concat(t),e.file),l.push({type:"image",file_index:t,content:e.content||""}))}),s.append("blocks",JSON.stringify(l));let i=await o.create(r,s);e({success:i.message,loading:!1})}catch(t){e({error:"Ошибка в создании задачи: "+t,loading:!1})}},clearMessages:()=>{e({error:null,success:null})}}),{name:"constructor-storage",storage:(0,n.KU)(()=>localStorage),partialize:e=>({subject:e.subject,task:e.task})}))},4753:e=>{e.exports={container:"TaskElement_container__Trljt",header:"TaskElement_header__yJkNu",delete:"TaskElement_delete__IBrBc",arrows:"TaskElement_arrows__yN1jW"}},6298:e=>{e.exports={input__container:"InputImage_input__container__tddxO",label:"InputImage_label___rHnc",preview:"InputImage_preview__yMoq2",preview__image:"InputImage_preview__image__urWFM"}},6307:e=>{e.exports={header:"CreateTaskHeader_header__hKTKQ",buttons:"CreateTaskHeader_buttons__E7pZi"}},6330:(e,t,r)=>{"use strict";r.d(t,{$:()=>o});var a=r(5155),n=r(6862),s=r.n(n);let o=e=>{let{children:t,disabled:r=!1,onClick:n,radius:o="32px",filled:l=!1,border:i,outlined:c=!1,color:d="text",style:u,type:h,width:_="auto",loading:p=!1,size:m="base",fontSize:g="base"}=e;return p&&(r=!0),(0,a.jsx)("button",{type:h,style:u||{zIndex:10,width:"full"===_?"100%":"auto",fontSize:"var(--".concat(g,")"),borderRadius:o,padding:"base"===m?"10px 25px":"5px 10px",backgroundColor:l?"var(--primary)":"transparent",color:d?"var(--".concat(d,")"):l?"var(--bg)":"var(--text)",border:i?"1px solid var(--".concat(i,")"):c?"1px solid var(--primary)":"none"},className:"".concat(s().button," ").concat(r?s().disabled:s().active," ").concat(c?s().outlined:""),disabled:r,onClick:n,children:p?(0,a.jsx)("span",{style:{fontSize:"1.2rem"},className:"".concat(s().spinner," ")}):t})}},6862:e=>{e.exports={button:"Button_button__MKRSq",disabled:"Button_disabled__zBBD3",active:"Button_active__ecv28",spinner:"Button_spinner__C4NUU",pulseSpin:"Button_pulseSpin__3QKkJ"}},7364:(e,t,r)=>{"use strict";r.d(t,{Header:()=>p});var a=r(5155);let n={src:"/_next/static/media/burger-menu.f63868ce.svg",height:40,width:40,blurWidth:0,blurHeight:0};var s=r(6330),o=r(3429),l=r.n(o),i=r(8056),c=r(6874),d=r.n(c),u=r(6766),h=r(7374),_=r(2115);let p=()=>{let e=(0,i.k)(e=>e.logout),t=(0,i.k)(e=>e.user),[r,o]=(0,_.useState)(!1);return(0,_.useEffect)(()=>{let e=()=>{window.scrollY>100?o(!0):o(!1)};return window.addEventListener("scroll",e),e(),()=>window.removeEventListener("scroll",e)},[]),(0,a.jsx)("header",{children:(0,a.jsx)("div",{className:"".concat(l().header," ").concat(r?l().scrolled:""),children:(0,a.jsxs)("div",{className:l().content__right,children:[(0,a.jsx)(u.default,{src:n,alt:"",className:l().burger}),(null==t?void 0:t.RoleName)==="Админ"&&(0,a.jsx)(d(),{href:"/admin",children:(0,a.jsx)(s.$,{color:"white",filled:!0,children:"admin"})}),(0,a.jsxs)("ul",{className:l().list,children:[(0,a.jsx)(h.H,{href:"/profile",size:"base",children:"Профиль"}),(0,a.jsx)(h.H,{href:"/profile/all-tasks",size:"base",children:"Мои задачи"}),(0,a.jsx)(h.H,{href:"/",size:"base",children:"Категории заданий"})]}),t?(0,a.jsx)(s.$,{outlined:!0,onClick:e,children:"Выйти"}):(0,a.jsx)(d(),{href:"/auth",children:(0,a.jsx)(s.$,{color:"white",filled:!0,children:"Войти"})})]})})})}},7374:(e,t,r)=>{"use strict";r.d(t,{H:()=>i});var a=r(5155),n=r(2078),s=r.n(n),o=r(6874),l=r.n(o);let i=e=>{let{children:t,href:r,size:n="base",...o}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("li",{...o,className:s().link,style:{fontSize:"var(--".concat(n,")")},children:(0,a.jsx)(l(),{href:r||"/",children:t})})})}},7465:e=>{e.exports={footer:"Footer_footer__0UEuE",bottom:"Footer_bottom__Cb1G_",line:"Footer_line__uYmv3",vertical__line:"Footer_vertical__line__lDeQ6","footer-sticky":"Footer_footer-sticky__E_fhZ",container:"Footer_container__MzX7a",mobile:"Footer_mobile__D4940",content:"Footer_content__vgu2q"}},8045:(e,t,r)=>{"use strict";r.d(t,{K:()=>o});var a=r(5155),n=r(4001),s=r.n(n);let o=e=>{let{children:t,width:r,color:n,borderColor:o}=e;return(0,a.jsx)("div",{className:s().outside__content,style:{maxWidth:r},children:(0,a.jsx)("div",{className:s().content,style:{backgroundColor:n?"var(--".concat(n,")"):"",border:o?"1px solid var(--".concat(n,")"):"1px solid var(--primary)",transition:"all 0.2s ease-in-out"},children:t})})}},8056:(e,t,r)=>{"use strict";r.d(t,{k:()=>o});var a=r(5453),n=r(6786),s=r(525);let o=(0,a.v)((0,n.Zr)((0,n.kg)({user:null,token:null,error:null,loading:!1},e=>({login:async(t,r)=>{e({loading:!0});try{let a=await s.A.loginV2(t,r);if(a.detail){e({error:{error:a.detail.error||"Validation Error",message:a.detail.message||"Invalid credentials"},loading:!1}),console.log(a.detail);return}e({user:a.student,token:a.access_token,error:null,loading:!1}),localStorage.setItem("token",a.access_token),console.log(localStorage.getItem("token"))}catch(r){let t="Authorization error";r instanceof Error&&(t=r.message),e({error:{error:"Authorization error",message:t},loading:!1}),console.log(r)}},logout:async()=>{try{let t=localStorage.getItem("token");await s.A.logout(t||""),e({user:null,token:null}),localStorage.removeItem("token")}catch(e){console.log(e)}},clearError:()=>e({error:null})})),{name:"user-storage"}))},9150:(e,t,r)=>{"use strict";r.d(t,{TaskConstructor:()=>b});var a=r(5155),n=r(8045),s=r(3208),o=r(6307),l=r.n(o),i=r(6330);let c=e=>{let{onAddElement:t,subject:r,task:o}=e;return(0,a.jsx)(n.K,{children:(0,a.jsxs)("div",{className:l().header,children:[(0,a.jsxs)(s.f,{children:[r,": ",o]}),(0,a.jsxs)("div",{className:l().buttons,children:[(0,a.jsx)(s.f,{children:"Добавить:"}),(0,a.jsx)(i.$,{filled:!0,color:"white",onClick:()=>t("text"),children:"Текст"}),(0,a.jsx)(i.$,{filled:!0,color:"white",onClick:()=>t("image"),children:"Изображение"})]})]})})};var d=r(2115),u=r(6298),h=r.n(u);let _=e=>{let{file:t,onChange:r}=e,[n,s]=(0,d.useState)(null);return(0,a.jsx)("div",{className:h().input__container,children:n?(0,a.jsxs)("div",{className:h().preview,children:[(0,a.jsx)("img",{src:n,alt:"Preview",className:h().preview__image}),(0,a.jsx)("i",{className:"pi pi-times",onClick:()=>{r(null),s(null)}})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("label",{className:h().label,children:[(0,a.jsx)("input",{type:"file",className:h().input,onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(a){r(a);let e=new FileReader;e.onload=e=>{var t;return s(null==(t=e.target)?void 0:t.result)},e.readAsDataURL(a)}},accept:"image/*"}),(0,a.jsx)("span",{children:"Загрузить файл"})]}),(0,a.jsx)("p",{className:h().hint,children:"PNG, JPG, GIF до 10MB"})]})})};var p=r(1152),m=r(4753),g=r.n(m);let x=e=>{let{element:t,onUpdate:r,onRemove:n,onMove:o}=e;return(0,a.jsxs)("div",{className:g().container,children:[(0,a.jsxs)("div",{className:g().header,children:[(0,a.jsx)("span",{children:"text"===t.type?(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,a.jsx)("i",{className:"pi pi-pen-to-square"}),(0,a.jsx)(s.f,{size:"tiny",children:"Текстовое поле"})]}):(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,a.jsx)("i",{className:"pi pi-image"}),(0,a.jsx)(s.f,{size:"tiny",children:"Изображение"})]})}),(0,a.jsxs)("div",{className:g().arrows,children:[(0,a.jsx)("i",{className:"pi pi-chevron-down",onClick:()=>o(t.id,"down")}),(0,a.jsx)("i",{className:"pi pi-chevron-up",onClick:()=>o(t.id,"up")})]}),(0,a.jsx)("div",{onClick:()=>n(t.id),className:g().delete,children:(0,a.jsx)("i",{className:"pi pi-trash"})})]}),"text"===t.type?(0,a.jsx)(p.f,{value:t.content||"",onChange:e=>r(t.id,{content:e})}):(0,a.jsx)(_,{file:t.file,onChange:e=>r(t.id,{file:e})})]})};var j=r(92),v=r.n(j),f=r(4403),k=r(4173);r(2878);let b=()=>{let{elements:e,addElement:t,updateElement:r,removeElement:o,moveElement:l,handleSave:u,loading:h,success:_,error:p}=(0,f.L)(),m=(0,d.useRef)(null),g=localStorage.getItem("constructor-storage"),[j,b]=(0,d.useState)(""),[y,w]=(0,d.useState)("");(0,d.useEffect)(()=>{let e=localStorage.getItem("constructor-storage");if(!e)return;let t=JSON.parse(e||"");b(t.state.subject.Name),w(t.state.task.TaskTitle)},[g]);let N=(e,t)=>{var r;null==(r=m.current)||r.show({severity:t,summary:e,life:3e3})};return(0,d.useEffect)(()=>{p&&N(p,"error"),_&&N(_,"success")},[p,_]),(0,a.jsxs)("div",{className:v().taskConstructor,children:[(0,a.jsx)(k.y,{ref:m,position:"bottom-left"}),(0,a.jsx)(c,{onAddElement:t,subject:j,task:y}),(0,a.jsx)(n.K,{children:(0,a.jsxs)("div",{className:v().container,children:[e.map(e=>(0,a.jsx)(x,{element:e,onUpdate:r,onRemove:o,onMove:l},e.id)),e.length>0&&(0,a.jsx)(i.$,{loading:h,color:"white",filled:!0,onClick:()=>u(),children:"Сохранить"}),0===e.length&&(0,a.jsx)("div",{children:(0,a.jsx)(s.f,{children:"Добавьте первый элемент задачи"})})]})})]})}},9624:e=>{e.exports={textarea:"TextArea_textarea__sC88j"}}},e=>{e.O(0,[6545,4599,7446,3068,2600,4786,8441,5964,7358],()=>e(e.s=3010)),_N_E=e.O()}]);