(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5837],{525:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});class n{static async login(e,t){return(await fetch("".concat("https://info-run.ru","/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Login:e,Password:t})})).json()}static async loginV2(e,t){return(await fetch("".concat("https://info-run.ru","/api/auth/login/v2"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:e,password:t})})).json()}static async logout(e){return(await fetch("".concat("https://info-run.ru","/api/auth/logout"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})).json()}static async resetPassword(e){return(await fetch("".concat("https://info-run.ru","/api/auth/password_reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Email:e})})).json()}static async resetPasswordWithToken(e,t,a){let n=await fetch("".concat("https://info-run.ru","/api/auth/password_reset_with_token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,new_password:t,repeat_new_password:a})});return n.status,n.json()}}},2078:e=>{e.exports={link:"AnimationLink_link__b_WaA"}},3208:(e,t,a)=>{"use strict";a.d(t,{f:()=>r});var n=a(5155);let r=e=>{let{children:t,size:a="base",f_weight:r="light",color:o}=e;return(0,n.jsx)("p",{style:{fontSize:"var(--".concat(a,")"),fontWeight:"var(--fw_".concat(r,")"),color:"var(--".concat(o,")")},children:t})}},3429:e=>{e.exports={header:"Header_header__mjk9B",scrolled:"Header_scrolled__UEvVD",content__right:"Header_content__right__Xotbx",list:"Header_list__Oc7Pz",burger:"Header_burger__do6Rn",theme_switcher:"Header_theme_switcher__kCJqk",dark:"Header_dark__lAzRt",light:"Header_light__Whbrs"}},4001:e=>{e.exports={outside__content:"ProfileContentContainer_outside__content__7rkiJ",content:"ProfileContentContainer_content__90rmg"}},4403:(e,t,a)=>{"use strict";a.d(t,{L:()=>i});var n=a(5453),r=a(6786);class o{static async getSubjects(e){return(await fetch("".concat("https://info-run.ru","/api/subjects"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})).json()}static async getTaskNumber(e,t){return(await fetch("".concat("https://info-run.ru","/api/tasks?subject_id=").concat(t),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})).json()}static async getVariants(e){return(await fetch("".concat("https://info-run.ru","/api/tasks/variants"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})).json()}}class s{static async create(e,t){return(await fetch("".concat("https://info-run.ru","/api/subtasks/create"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:t})).json()}}let i=(0,n.v)()((0,r.Zr)((e,t)=>({loading:!1,error:null,success:null,subject:null,subjects:[],task:null,variants:[],variant:null,answer:"",image:null,tasks:[],elements:[],getSubjects:async()=>{e({loading:!0});let t=localStorage.getItem("token")||"";try{let a=await o.getSubjects(t);e({subjects:a.subjects,loading:!1})}catch(t){e({error:"Ошибка получения данных"+t,loading:!1})}},setSubject:t=>{e({subject:t})},getTaskNumber:async t=>{e({loading:!0});let a=localStorage.getItem("token")||"";try{let n=await o.getTaskNumber(a,t);e({tasks:n.tasks,loading:!1})}catch(t){e({error:"Ошибка получения данных"+t,loading:!1})}},setTask:t=>{e({task:t})},getVarinants:async()=>{e({loading:!0});let t=localStorage.getItem("token")||"";try{let a=await o.getVariants(t);e({variants:a,loading:!1})}catch(t){e({error:"Ошибка получения данных"+t,loading:!1})}},setVariant:t=>{e({variant:t})},setAnswer:t=>{e({answer:t})},setImage:t=>{e({image:t})},moveElement:(t,a)=>{e(e=>({elements:e.elements.map(n=>{if(n.id===t){let t=e.elements.indexOf(n);if("up"===a&&t>0)return e.elements[t-1];if("down"===a&&t<e.elements.length-1)return e.elements[t+1]}return n})}))},addElement:t=>{let a={id:Date.now().toString(),type:t,content:"text"===t?"":void 0,file:"image"===t?null:void 0};e(e=>({elements:[...e.elements,a]}))},updateElement:(t,a)=>{e(e=>({elements:e.elements.map(e=>e.id===t?{...e,...a}:e)}))},removeElement:t=>{e(e=>({elements:e.elements.filter(e=>e.id!==t)}))},handleSave:async()=>{e({loading:!0,success:null,error:null});let a=localStorage.getItem("token")||"",n=JSON.parse(localStorage.getItem("constructor-storage")||"").state.task.TaskID;try{var r;let o=new FormData;(null==(r=t().task)?void 0:r.TaskID)&&o.append("task_id",n);let i=[];t().elements.forEach((e,t)=>{"text"===e.type?i.push({type:"text",content:e.content||""}):"image"===e.type&&e.file&&(o.append("file_".concat(t),e.file),i.push({type:"image",file_index:t,content:e.content||""}))}),o.append("blocks",JSON.stringify(i));let l=await s.create(a,o);e({success:l.message,loading:!1})}catch(t){e({error:"Ошибка в создании задачи: "+t,loading:!1})}},clearMessages:()=>{e({error:null,success:null})}}),{name:"constructor-storage",storage:(0,r.KU)(()=>localStorage),partialize:e=>({subject:e.subject,task:e.task,variant:e.variant,answer:e.answer})}))},6330:(e,t,a)=>{"use strict";a.d(t,{$:()=>s});var n=a(5155),r=a(6862),o=a.n(r);let s=e=>{let{children:t,disabled:a=!1,onClick:r,radius:s="32px",filled:i=!1,border:l,outlined:c=!1,color:d="text",style:u,type:h,width:_="auto",loading:g=!1,size:p="base",fontSize:m="base"}=e;return g&&(a=!0),(0,n.jsx)("button",{type:h,style:u||{zIndex:10,width:"full"===_?"100%":"auto",fontSize:"var(--".concat(m,")"),borderRadius:s,padding:"base"===p?"10px 25px":"5px 10px",backgroundColor:i?"var(--primary)":"transparent",color:d?"var(--".concat(d,")"):i?"var(--bg)":"var(--text)",border:l?"1px solid var(--".concat(l,")"):c?"1px solid var(--primary)":"none"},className:"".concat(o().button," ").concat(a?o().disabled:o().active," ").concat(c?o().outlined:""),disabled:a,onClick:r,children:g?(0,n.jsx)("span",{style:{fontSize:"1.2rem"},className:"".concat(o().spinner," ")}):t})}},6862:e=>{e.exports={button:"Button_button__MKRSq",disabled:"Button_disabled__zBBD3",active:"Button_active__ecv28",spinner:"Button_spinner__C4NUU",pulseSpin:"Button_pulseSpin__3QKkJ"}},7364:(e,t,a)=>{"use strict";a.d(t,{Header:()=>g});var n=a(5155);let r={src:"/_next/static/media/burger-menu.f63868ce.svg",height:40,width:40,blurWidth:0,blurHeight:0};var o=a(6330),s=a(3429),i=a.n(s),l=a(8056),c=a(6874),d=a.n(c),u=a(6766),h=a(7374),_=a(2115);let g=()=>{let e=(0,l.k)(e=>e.logout),t=(0,l.k)(e=>e.user),[a,s]=(0,_.useState)(!1);return(0,_.useEffect)(()=>{let e=()=>{window.scrollY>100?s(!0):s(!1)};return window.addEventListener("scroll",e),e(),()=>window.removeEventListener("scroll",e)},[]),(0,n.jsx)("header",{children:(0,n.jsx)("div",{className:"".concat(i().header," ").concat(a?i().scrolled:""),children:(0,n.jsxs)("div",{className:i().content__right,children:[(0,n.jsx)(u.default,{src:r,alt:"",className:i().burger}),(null==t?void 0:t.RoleName)==="Админ"&&(0,n.jsx)(d(),{href:"/admin",children:(0,n.jsx)(o.$,{color:"white",filled:!0,children:"admin"})}),(0,n.jsxs)("ul",{className:i().list,children:[(0,n.jsx)(h.H,{href:"/profile",size:"base",children:"Профиль"}),(0,n.jsx)(h.H,{href:"/profile/all-tasks",size:"base",children:"Мои задачи"}),(0,n.jsx)(h.H,{href:"/",size:"base",children:"Категории заданий"})]}),t?(0,n.jsx)(o.$,{outlined:!0,onClick:e,children:"Выйти"}):(0,n.jsx)(d(),{href:"/auth",children:(0,n.jsx)(o.$,{color:"white",filled:!0,children:"Войти"})})]})})})}},7374:(e,t,a)=>{"use strict";a.d(t,{H:()=>l});var n=a(5155),r=a(2078),o=a.n(r),s=a(6874),i=a.n(s);let l=e=>{let{children:t,href:a,size:r="base",...s}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("li",{...s,className:o().link,style:{fontSize:"var(--".concat(r,")")},children:(0,n.jsx)(i(),{href:a||"/",children:t})})})}},7465:e=>{e.exports={footer:"Footer_footer__0UEuE",bottom:"Footer_bottom__Cb1G_",line:"Footer_line__uYmv3",vertical__line:"Footer_vertical__line__lDeQ6","footer-sticky":"Footer_footer-sticky__E_fhZ",container:"Footer_container__MzX7a",mobile:"Footer_mobile__D4940",content:"Footer_content__vgu2q"}},8045:(e,t,a)=>{"use strict";a.d(t,{K:()=>s});var n=a(5155),r=a(4001),o=a.n(r);let s=e=>{let{children:t,width:a,color:r,borderColor:s}=e;return(0,n.jsx)("div",{className:o().outside__content,style:{maxWidth:a},children:(0,n.jsx)("div",{className:o().content,style:{backgroundColor:r?"var(--".concat(r,")"):"",border:s?"1px solid var(--".concat(r,")"):"1px solid var(--primary)",transition:"all 0.2s ease-in-out"},children:t})})}},8056:(e,t,a)=>{"use strict";a.d(t,{k:()=>s});var n=a(5453),r=a(6786),o=a(525);let s=(0,n.v)((0,r.Zr)((0,r.kg)({user:null,token:null,error:null,loading:!1},e=>({login:async(t,a)=>{e({loading:!0});try{let n=await o.A.loginV2(t,a);if(n.detail){e({error:{error:n.detail.error||"Validation Error",message:n.detail.message||"Invalid credentials"},loading:!1}),console.log(n.detail);return}e({user:n.student,token:n.access_token,error:null,loading:!1}),localStorage.setItem("token",n.access_token),console.log(localStorage.getItem("token"))}catch(a){let t="Authorization error";a instanceof Error&&(t=a.message),e({error:{error:"Authorization error",message:t},loading:!1}),console.log(a)}},logout:async()=>{try{let t=localStorage.getItem("token");await o.A.logout(t||""),e({user:null,token:null}),localStorage.removeItem("token")}catch(e){console.log(e)}},clearError:()=>e({error:null})})),{name:"user-storage"}))}}]);